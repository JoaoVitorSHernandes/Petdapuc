<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
        rel="stylesheet">
    <link rel="icon" href="../imgs/logo.png">
    <title>Administrador</title>
</head>

<body>
    <section class="marginInAllElements">
        <p>Administrador</p>
        <div class="alignSairEditar">
            <a href="../login/index.html">Sair</a>
            <a href="../editar/index.html">Editar dados</a>
        </div>

        <div class="vetList">
            <div class="alignInsideVetList">
                <p>Veterinários</p>
                <div class="addVetButton">
                    <a href="#" onclick="return abrirPopupNewVet();">Adicionar Veterinário</a>
                </div>
            </div>
        </div>

        <div class="servicesBox">
            <div class="wordAndButton">
                <p>Serviços</p>
                <a href="#" onclick="return abrirPopupCriarServico();">Criar Serviço</a>
            </div>

            <div class="overflowBoxes">
                <div class="Box" style="margin: 16px 0 0 0;" id="servico-inicial-1"> <img src="../imgs/banho.png"
                        alt="Banho">
                    <div class="alignServiceNameAndExcluirEditar">
                        <p>Banho</p>
                        <div class="excluirAndEditar">
                            <a href="#" class="excluir">Excluir</a>
                            <a href="#" onclick="abrirPopupEditService('servico-inicial-1'); return false;">Editar</a>
                        </div>
                    </div>
                </div>

                <div class="Box" style="margin-left: 15px;" id="servico-inicial-2"> <img src="../imgs/tosa.jpeg"
                        alt="Tosa">
                    <div class="alignServiceNameAndExcluirEditar">
                        <p>Tosa</p>
                        <div class="excluirAndEditar">
                            <a href="#" class="excluir">Excluir</a>
                            <a href="#" onclick="abrirPopupEditService('servico-inicial-2'); return false;">Editar</a>
                        </div>
                    </div>
                </div>

                <div class="Box" id="servico-inicial-3"> <img src="../imgs/adestramento.png"
                        alt="Nome do Serviço Inicial 3">
                    <div class="alignServiceNameAndExcluirEditar">
                        <p>Adestramento</p>
                        <div class="excluirAndEditar">
                            <a href="#" class="excluir">Excluir</a>
                            <a href="#" onclick="abrirPopupEditService('servico-inicial-3'); return false;">Editar</a>
                        </div>
                    </div>
                </div>

                <div class="Box" id="servico-inicial-3"> <img src="../imgs/vacina.png" alt="Vacina">
                    <div class="alignServiceNameAndExcluirEditar">
                        <p>Vacina</p>
                        <div class="excluirAndEditar">
                            <a href="#" class="excluir">Excluir</a>
                            <a href="#" onclick="abrirPopupEditService('servico-inicial-3'); return false;">Editar</a>
                        </div>
                    </div>
                </div>

                <div class="Box" id="servico-inicial-3"> <img src="../imgs/lazer.png" alt="Lazer">
                    <div class="alignServiceNameAndExcluirEditar">
                        <p>Lazer</p>
                        <div class="excluirAndEditar">
                            <a href="#" class="excluir">Excluir</a>
                            <a href="#" onclick="abrirPopupEditService('servico-inicial-3'); return false;">Editar</a>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <div id="popupContainer" class="popups" style="display:none;">
            <div class="popup1">
                <span id="popupX" onclick="fecharPopupCriarServico()">X</span>
                <form id="formNewService">
                    <p>Criar serviço</p>
                    <div class="alignInputsPopup">
                        <input type="text" placeholder="Nome" id="newServiceNameInput">
                        <input type="text" placeholder="Descrição" id="newServiceDescInput">
                        <input type="text" placeholder="Duração" id="newServiceDurationInput">
                        <input type="text" placeholder="Preço" id="newServicePriceInput">
                    </div>
                    <button type="submit">Criar serviço</button>
                </form>
            </div>
        </div>



        <div class="secondServicesBox">
            <div class="wordAndButton">
                <p>Serviços agendados</p>
            </div>

            <div class="horizontalAlignStraightBoxes">
                <div class="alignStraightBoxes">
                    <div class="straightBox">
                        <img src="../imgs/banho.png" alt="Banho">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Banho</p>
                                <p>Dr. Carlos Silva</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Rex</p>
                                <p>15/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/tosa.jpeg" alt="Tosa">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Tosa</p>
                                <p>Dra. Ana Santos</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Mimi</p>
                                <p>16/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/adestramento.png" alt="Adestramento">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Adestramento</p>
                                <p>Dr. Pedro Costa</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>PiuPiu</p>
                                <p>17/03/2024</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="alignStraightBoxes" style="margin-left: 10px;">
                    <div class="straightBox">
                        <img src="../imgs/vacina.png" alt="Vacina">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Vacina</p>
                                <p>Dra. Juliana Lima</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Rex</p>
                                <p>18/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/lazer.png" alt="Lazer">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Lazer</p>
                                <p>Dr. Roberto Alves</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Mimi</p>
                                <p>19/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/banho.png" alt="Banho">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Banho</p>
                                <p>Dra. Mariana Costa</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>PiuPiu</p>
                                <p>20/03/2024</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="alignStraightBoxes" style="margin-left: 10px;">
                    <div class="straightBox">
                        <img src="../imgs/tosa.jpeg" alt="Tosa">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Tosa</p>
                                <p>Dr. André Silva</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Rex</p>
                                <p>21/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/adestramento.png" alt="Adestramento">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Adestramento</p>
                                <p>Dra. Beatriz Santos</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Mimi</p>
                                <p>22/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/vacina.png" alt="Vacina">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Vacina</p>
                                <p>Dr. Rafael Costa</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>PiuPiu</p>
                                <p>23/03/2024</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="alignStraightBoxes" style="margin-left: 10px;">
                    <div class="straightBox">
                        <img src="../imgs/lazer.png" alt="Lazer">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Lazer</p>
                                <p>Dra. Camila Alves</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Rex</p>
                                <p>24/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/banho.png" alt="Banho">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Banho</p>
                                <p>Dr. Daniel Silva</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Mimi</p>
                                <p>25/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/tosa.jpeg" alt="Tosa">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Tosa</p>
                                <p>Dra. Elisa Santos</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>PiuPiu</p>
                                <p>26/03/2024</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="alignStraightBoxes" style="margin-left: 10px;">
                    <div class="straightBox">
                        <img src="../imgs/adestramento.png" alt="Adestramento">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Adestramento</p>
                                <p>Dr. Felipe Costa</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Rex</p>
                                <p>27/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/vacina.png" alt="Vacina">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Vacina</p>
                                <p>Dra. Gabriela Alves</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Mimi</p>
                                <p>28/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/lazer.png" alt="Lazer">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Lazer</p>
                                <p>Dr. Henrique Silva</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>PiuPiu</p>
                                <p>29/03/2024</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="secondServicesBox">
            <div class="wordAndButton">
                <p>Histórico de serviços</p>
            </div>

            <div class="horizontalAlignStraightBoxes">
                <div class="alignStraightBoxes">
                    <div class="straightBox">
                        <img src="../imgs/banho.png" alt="Banho">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Banho</p>
                                <p>Dr. Carlos Silva</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Rex</p>
                                <p>01/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/tosa.jpeg" alt="Tosa">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Tosa</p>
                                <p>Dra. Ana Santos</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Mimi</p>
                                <p>02/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/adestramento.png" alt="Adestramento">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Adestramento</p>
                                <p>Dr. Pedro Costa</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>PiuPiu</p>
                                <p>03/03/2024</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="alignStraightBoxes" style="margin-left: 10px;">
                    <div class="straightBox">
                        <img src="../imgs/vacina.png" alt="Vacina">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Vacina</p>
                                <p>Dra. Juliana Lima</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Rex</p>
                                <p>04/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/lazer.png" alt="Lazer">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Lazer</p>
                                <p>Dr. Roberto Alves</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Mimi</p>
                                <p>05/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/banho.png" alt="Banho">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Banho</p>
                                <p>Dra. Mariana Costa</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>PiuPiu</p>
                                <p>06/03/2024</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="alignStraightBoxes" style="margin-left: 10px;">
                    <div class="straightBox">
                        <img src="../imgs/tosa.jpeg" alt="Tosa">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Tosa</p>
                                <p>Dr. André Silva</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Rex</p>
                                <p>07/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/adestramento.png" alt="Adestramento">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Adestramento</p>
                                <p>Dra. Beatriz Santos</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Mimi</p>
                                <p>08/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/vacina.png" alt="Vacina">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Vacina</p>
                                <p>Dr. Rafael Costa</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>PiuPiu</p>
                                <p>09/03/2024</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="alignStraightBoxes" style="margin-left: 10px;">
                    <div class="straightBox">
                        <img src="../imgs/lazer.png" alt="Lazer">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Lazer</p>
                                <p>Dra. Camila Alves</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Rex</p>
                                <p>10/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/banho.png" alt="Banho">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Banho</p>
                                <p>Dr. Daniel Silva</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Mimi</p>
                                <p>11/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/tosa.jpeg" alt="Tosa">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Tosa</p>
                                <p>Dra. Elisa Santos</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>PiuPiu</p>
                                <p>12/03/2024</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="alignStraightBoxes" style="margin-left: 10px;">
                    <div class="straightBox">
                        <img src="../imgs/adestramento.png" alt="Adestramento">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Adestramento</p>
                                <p>Dr. Felipe Costa</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Rex</p>
                                <p>13/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/vacina.png" alt="Vacina">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Vacina</p>
                                <p>Dra. Gabriela Alves</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>Mimi</p>
                                <p>14/03/2024</p>
                            </div>
                        </div>
                    </div>
                    <div class="straightBox">
                        <img src="../imgs/lazer.png" alt="Lazer">
                        <div class="alignamesanddates">
                            <div class="nomeServicoEVeterinario">
                                <p>Lazer</p>
                                <p>Dr. Henrique Silva</p>
                            </div>
                            <div class="nomeDonoEData">
                                <p>PiuPiu</p>
                                <p>15/03/2024</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="popupContainer" class="popups" style="display:none;">
            <div class="popup1">
                <span id="popupX_servico" onclick="fecharPopupCriarServico()">X</span>
                <form id="formNewService">
                    <p>Criar serviço</p>
                    <div class="alignInputsPopup">
                        <input type="text" placeholder="Nome" id="newServiceNameInput">
                        <input type="text" placeholder="Descrição" id="newServiceDescInput">
                        <input type="text" placeholder="Duração" id="newServiceDurationInput">
                        <input type="text" placeholder="Preço" id="newServicePriceInput">
                    </div>
                    <button type="submit">Criar serviço</button>
                </form>
            </div>
        </div>

        <div id="popupContainerNewVet" class="popupsNewVet" style="display:none;">
            <div class="popup2">
                <span id="popupX2" onclick="fecharPopupNewVet()">X</span>
                <form id="formNewVet">
                    <p>Novo veterinário</p>
                    <div class="alignInputsPopup">
                        <input type="text" placeholder="Nome" id="newVetNameInput">
                        <input type="text" placeholder="Data de nascimento" id="newVetDobInput">
                        <input type="text" placeholder="CPF" id="newVetCpfInput">
                        <input type="text" placeholder="Telefone" id="newVetPhoneInput">
                        <input type="text" placeholder="Senha" id="newVetPasswordInput">
                    </div>
                    <button type="submit">Adicionar</button>
                </form>
            </div>
        </div>
        <div id="popupContainerEditVet" class="popupsEditVet" style="display:none;">
            <div class="popup3">
                <span id="popupX3" onclick="fecharPopupEditVet()">X</span>
                <form id="formEditVet">
                    <p>Editar veterinário</p>
                    <div class="alignInputsPopup">
                        <input type="text" placeholder="Nome" id="editVetNameInput">
                        <input type="text" placeholder="Data de nascimento" id="editVetDobInput">
                        <input type="text" placeholder="CPF" id="editVetCpfInput">
                        <input type="text" placeholder="Telefone" id="editVetPhoneInput">
                    </div>
                    <button type="submit">Salvar</button>
                </form>
            </div>
        </div>
        <div id="popupContainerEditService" class="popupsEditService" style="display:none;">
            <div class="popup4">
                <span id="popupX4" onclick="fecharPopupEditService()">X</span>
                <form id="formEditService">
                    <p>Editar serviço</p>
                    <div class="alignInputsPopup">
                        <input type="text" placeholder="Nome" id="editServiceNameInput">
                        <input type="text" placeholder="Descrição" id="editServiceDescInput">
                        <input type="text" placeholder="Duração" id="editServiceDurationInput">
                        <input type="text" placeholder="Preço" id="editServicePriceInput">
                    </div>
                    <button type="submit">Salvar</button>
                </form>
            </div>
        </div>

        <script>
            console.log("SCRIPT: Definindo funções globais...");

            let formNewVetSubmitCount = 0;

            function abrirPopupCriarServico() {
                const container = document.getElementById("popupContainer");
                if (container) {
                    console.log("POPUP_CRIAR_SERVICO: abrirPopupCriarServico() chamada.");
                    const form = container.querySelector('#formNewService');
                    if (form) {
                        form.reset();
                        const submitButton = form.querySelector('button[type="submit"]');
                        if (submitButton) submitButton.disabled = false;
                    }
                    container.style.display = "flex";
                } else {
                    console.error("POPUP_CRIAR_SERVICO: Erro - #popupContainer não encontrado.");
                }
                return false;
            }

            function fecharPopupCriarServico() {
                const container = document.getElementById("popupContainer");
                if (container) {
                    container.style.display = "none";
                } else {
                    console.error("POPUP_CRIAR_SERVICO: Erro - #popupContainer não encontrado.");
                }
            }

            function fecharPopupNewVet() {
                const container = document.getElementById("popupContainerNewVet");
                if (container) {
                    container.style.display = "none";
                    const form = container.querySelector('#formNewVet');
                    if (form) {
                        const submitButton = form.querySelector('button[type="submit"]');
                        if (submitButton) submitButton.disabled = false;
                    }
                } else {
                    console.error("POPUP_VET_NEW: Erro - #popupContainerNewVet não encontrado para fechar.");
                }
            }

            function updateAddVetButtonState() {
                const vetListContainer = document.querySelector('.alignInsideVetList');
                if (!vetListContainer) { return; }
                const addVetMainButtonLink = vetListContainer.querySelector('.addVetButton a');
                if (!addVetMainButtonLink) { return; }
                const vetCount = vetListContainer.querySelectorAll('.borderNameVets').length;
                addVetMainButtonLink.style.pointerEvents = (vetCount >= 3) ? 'none' : 'auto';
                addVetMainButtonLink.style.opacity = (vetCount >= 3) ? '0.5' : '1';
            }

            function abrirPopupNewVet() {
                const vetListContainer = document.querySelector('.alignInsideVetList');
                if (!vetListContainer) {
                    console.error("POPUP_VET_NEW: Contêiner .alignInsideVetList não encontrado.");
                    return false;
                }
                const existingVets = vetListContainer.querySelectorAll('.borderNameVets');
                if (existingVets.length >= 3) {
                    alert("Você pode adicionar no máximo 3 veterinários.");
                    updateAddVetButtonState();
                    return false;
                }
                const container = document.getElementById("popupContainerNewVet");
                if (container) {
                    container.style.display = "flex";
                    const form = container.querySelector('#formNewVet');
                    if (form) {
                        form.reset();
                        const submitButton = form.querySelector('button[type="submit"]');
                        if (submitButton) {
                            submitButton.disabled = false;
                        }
                    } else {
                        console.error("POPUP_VET_NEW: Form #formNewVet não encontrado dentro de #popupContainerNewVet.");
                    }
                } else {
                    console.error("POPUP_VET_NEW: Popup #popupContainerNewVet não encontrado.");
                }
                return false;
            }

            function fecharPopupEditVet() {
                const container = document.getElementById("popupContainerEditVet");
                if (container) {
                    container.style.display = "none";
                    const form = container.querySelector('#formEditVet');
                    if (form) {
                        form.reset();
                        delete form.dataset.editingVetId;
                        const submitButton = form.querySelector('button[type="submit"]');
                        if (submitButton) submitButton.disabled = false;
                    }
                }
            }

            function abrirPopupEditVet(vetId) {
                const vetElement = document.getElementById(vetId);
                const formEditVet = document.getElementById('formEditVet');
                if (!vetElement || !formEditVet) {
                    console.error(`POPUP_VET_EDIT: Vet (${vetId}) ou formEditVet não encontrado.`);
                    alert(`Erro ao tentar editar veterinário. ID: ${vetId}. Verifique o console.`);
                    return false;
                }
                formEditVet.dataset.editingVetId = vetId;
                const nameInput = formEditVet.querySelector('#editVetNameInput');
                const dobInput = formEditVet.querySelector('#editVetDobInput');
                const cpfInput = formEditVet.querySelector('#editVetCpfInput');
                const phoneInput = formEditVet.querySelector('#editVetPhoneInput');

                if (nameInput) nameInput.value = vetElement.querySelector('p')?.textContent || '';
                if (dobInput) dobInput.value = vetElement.dataset.dob || '';
                if (cpfInput) cpfInput.value = vetElement.dataset.cpf || '';
                if (phoneInput) phoneInput.value = vetElement.dataset.phone || '';

                const containerPopup = document.getElementById("popupContainerEditVet");
                if (containerPopup) {
                    containerPopup.style.display = "flex";
                    const submitButton = formEditVet.querySelector('button[type="submit"]');
                    if (submitButton) submitButton.disabled = false;
                }
                return false;
            }

            function fecharPopupEditService() {
                const container = document.getElementById("popupContainerEditService");
                if (container) {
                    container.style.display = "none";
                    const form = container.querySelector('#formEditService');
                    if (form) {
                        form.reset();
                        delete form.dataset.editingServiceId;
                        const submitButton = form.querySelector('button[type="submit"]');
                        if (submitButton) submitButton.disabled = false;
                    }
                }
            }

            function abrirPopupEditService(serviceId) {
                console.log(`POPUP_SERVICE_EDIT: Iniciando abrirPopupEditService para ID: "${serviceId}" (tipo: ${typeof serviceId})`);

                const serviceElement = document.getElementById(serviceId);
                console.log(`POPUP_SERVICE_EDIT: Resultado de document.getElementById("${serviceId}"):`, serviceElement);

                const formEditService = document.getElementById('formEditService');

                if (!serviceElement) {
                    console.error(`POPUP_SERVICE_EDIT: FALHA - Serviço com ID "${serviceId}" NÃO ENCONTRADO na lista.`);
                    alert(`Erro: Serviço com ID "${serviceId}" não encontrado para edição. Verifique o console.`);
                    return false;
                }
                if (!formEditService) {
                    console.error('POPUP_SERVICE_EDIT: FALHA - Formulário #formEditService não encontrado no HTML do popup.');
                    alert('Erro: Formulário de edição de serviço não configurado (sem ID="formEditService"). Verifique o console (F12).');
                    return false;
                }

                formEditService.dataset.editingServiceId = serviceId;
                console.log(`POPUP_SERVICE_EDIT: Armazenado editingServiceId = ${serviceId} no formulário.`);

                const nameOnCardElement = serviceElement.querySelector('.alignServiceNameAndExcluirEditar p');
                const currentName = nameOnCardElement ? nameOnCardElement.textContent : '';

                const nameInput = formEditService.querySelector('#editServiceNameInput');
                const descInput = formEditService.querySelector('#editServiceDescInput');
                const durationInput = formEditService.querySelector('#editServiceDurationInput');
                const priceInput = formEditService.querySelector('#editServicePriceInput');

                if (nameInput) nameInput.value = currentName;
                if (descInput) descInput.value = serviceElement.dataset.description || '';
                if (durationInput) durationInput.value = serviceElement.dataset.duration || '';
                if (priceInput) priceInput.value = serviceElement.dataset.price || '';

                console.log(`POPUP_SERVICE_EDIT: Dados carregados - Nome: "${nameInput?.value}", Desc: "${descInput?.value}", Duração: "${durationInput?.value}", Preço: "${priceInput?.value}"`);

                const containerPopup = document.getElementById("popupContainerEditService");
                if (containerPopup) {
                    containerPopup.style.display = "flex";
                    const submitButton = formEditService.querySelector('button[type="submit"]');
                    if (submitButton) submitButton.disabled = false;
                    console.log("POPUP_SERVICE_EDIT: Popup de edição de serviço exibido.");
                }
                return false;
            }

            function fecharSeClicarFora(event) {
                if (event.target.classList.contains('popups') ||
                    event.target.classList.contains('popupsNewVet') ||
                    event.target.classList.contains('popupsEditVet') ||
                    event.target.classList.contains('popupsEditService')) {

                    if (event.target === event.currentTarget) {
                        console.log(`FECHAR_FORA: Clicado no overlay do popup ${event.target.id}.`);
                        switch (event.target.id) {
                            case 'popupContainer': fecharPopupCriarServico(); break;
                            case 'popupContainerNewVet': fecharPopupNewVet(); break;
                            case 'popupContainerEditVet': fecharPopupEditVet(); break;
                            case 'popupContainerEditService': fecharPopupEditService(); break;
                            default: event.target.style.display = 'none';
                        }
                    }
                }
            }



            document.addEventListener("DOMContentLoaded", function () {
                console.log("SCRIPT GLOBAL: DOMContentLoaded disparado ÚNICA VEZ.");

                document.querySelectorAll('.popups, .popupsNewVet, .popupsEditVet, .popupsEditService').forEach(popupContainer => {
                    if (popupContainer) {
                        popupContainer.addEventListener('click', fecharSeClicarFora);
                    }
                });

                const formNewVet = document.getElementById('formNewVet');
                if (formNewVet) {
                    if (!formNewVet.hasAttribute('data-listener-attached')) {
                        formNewVet.addEventListener('submit', function (event) {
                            formNewVetSubmitCount++;
                            console.log(`VET_ADD_SUBMIT: Iniciando #${formNewVetSubmitCount}`);
                            event.preventDefault();
                            const submitButton = formNewVet.querySelector('button[type="submit"]');
                            if (submitButton) submitButton.disabled = true;

                            const vetListContainer = document.querySelector('.alignInsideVetList');
                            const addVetButtonElement = vetListContainer ? vetListContainer.querySelector('.addVetButton') : null;
                            if (!vetListContainer || !addVetButtonElement) {
                                console.error("VET_ADD_SUBMIT: .alignInsideVetList ou .addVetButton não encontrado.");
                                if (submitButton) submitButton.disabled = false; return;
                            }
                            const existingVets = vetListContainer.querySelectorAll('.borderNameVets');
                            if (existingVets.length < 3) {
                                const vetNameInput = document.getElementById('newVetNameInput');
                                let newVetName = vetNameInput ? vetNameInput.value.trim() : `Veterinário ${existingVets.length + 1}`;
                                if (vetNameInput && !vetNameInput.value.trim()) {
                                    alert("Por favor, insira o nome do veterinário."); vetNameInput.focus();
                                    if (submitButton) submitButton.disabled = false; return;
                                }
                                const vetDobInput = document.getElementById('newVetDobInput');
                                const vetCpfInput = document.getElementById('newVetCpfInput');
                                const vetPhoneInput = document.getElementById('newVetPhoneInput');
                                const newVetDob = vetDobInput ? vetDobInput.value.trim() : '';
                                const newVetCpf = vetCpfInput ? vetCpfInput.value.trim() : '';
                                const newVetPhone = vetPhoneInput ? vetPhoneInput.value.trim() : '';
                                const newVetId = `vet-${Date.now()}-${Math.random().toString(36).substring(2, 7)}`;

                                const newVetDiv = document.createElement('div');
                                newVetDiv.className = 'borderNameVets'; newVetDiv.id = newVetId;
                                if (newVetDob) newVetDiv.dataset.dob = newVetDob;
                                if (newVetCpf) newVetDiv.dataset.cpf = newVetCpf;
                                if (newVetPhone) newVetDiv.dataset.phone = newVetPhone;

                                const nameParagraph = document.createElement('p'); nameParagraph.textContent = newVetName;
                                const actionsDiv = document.createElement('div');
                                const deleteLink = document.createElement('a');
                                deleteLink.href = "#"; deleteLink.className = 'excluir'; deleteLink.textContent = 'Excluir';
                                deleteLink.style.cssText = "text-decoration: none; font-size: 11px; font-family: Inter; font-weight: 500; color: #DB3938;";
                                deleteLink.addEventListener('click', function (e) { e.preventDefault(); newVetDiv.remove(); updateAddVetButtonState(); });
                                const editLink = document.createElement('a');
                                editLink.href = "#"; editLink.textContent = 'Editar';
                                editLink.style.cssText = "text-decoration: none; font-size: 11px; font-family: Inter; font-weight: 500; color: #3A8AD3; margin-left: 16px;";
                                editLink.onclick = function (e) { e.preventDefault(); abrirPopupEditVet(newVetId); return false; };

                                actionsDiv.appendChild(deleteLink); actionsDiv.appendChild(editLink);
                                newVetDiv.appendChild(nameParagraph); newVetDiv.appendChild(actionsDiv);
                                vetListContainer.insertBefore(newVetDiv, addVetButtonElement);
                                fecharPopupNewVet(); updateAddVetButtonState();
                                console.log(`VET_ADD_SUBMIT: Vet ${newVetId} ADICIONADO.`);
                            } else {
                                alert("Limite de veterinários atingido."); fecharPopupNewVet(); updateAddVetButtonState();
                            }
                        });
                        formNewVet.setAttribute('data-listener-attached', 'true');
                        console.log("SCRIPT: Listener de SUBMIT para #formNewVet ADICIONADO.");
                    } else { console.log("SCRIPT: Listener de SUBMIT para #formNewVet JÁ EXISTIA (devido ao data-listener-attached)."); }
                } else { console.error('SCRIPT_ERROR: Formulário #formNewVet NÃO encontrado!'); }

                const formEditVet = document.getElementById('formEditVet');
                if (formEditVet) {
                    if (!formEditVet.hasAttribute('data-listener-attached')) {
                        formEditVet.addEventListener('submit', function (event) {
                            console.log("VET_EDIT_SUBMIT: Iniciando...");
                            event.preventDefault();
                            const submitButton = formEditVet.querySelector('button[type="submit"]');
                            if (submitButton) submitButton.disabled = true;

                            const vetIdToUpdate = formEditVet.dataset.editingVetId;
                            if (!vetIdToUpdate) { console.error("VET_EDIT_SUBMIT: ID do vet não encontrado."); fecharPopupEditVet(); if (submitButton) submitButton.disabled = false; return; }

                            const newNameInput = formEditVet.querySelector('#editVetNameInput');
                            const newName = newNameInput ? newNameInput.value.trim() : '';
                            if (newNameInput && !newName) { alert("Nome não pode ser vazio."); newNameInput.focus(); if (submitButton) submitButton.disabled = false; return; }

                            const vetElementToUpdate = document.getElementById(vetIdToUpdate);
                            if (vetElementToUpdate) {
                                const nameParagraph = vetElementToUpdate.querySelector('p');
                                if (nameParagraph) nameParagraph.textContent = newName;

                                const vetDobInput = formEditVet.querySelector('#editVetDobInput');
                                const vetCpfInput = formEditVet.querySelector('#editVetCpfInput');
                                const vetPhoneInput = formEditVet.querySelector('#editVetPhoneInput');
                                if (vetDobInput && vetDobInput.value.trim()) vetElementToUpdate.dataset.dob = vetDobInput.value.trim(); else delete vetElementToUpdate.dataset.dob;
                                if (vetCpfInput && vetCpfInput.value.trim()) vetElementToUpdate.dataset.cpf = vetCpfInput.value.trim(); else delete vetElementToUpdate.dataset.cpf;
                                if (vetPhoneInput && vetPhoneInput.value.trim()) vetElementToUpdate.dataset.phone = vetPhoneInput.value.trim(); else delete vetElementToUpdate.dataset.phone;
                                console.log(`VET_EDIT_SUBMIT: Vet ${vetIdToUpdate} atualizado.`);
                                alert(`Veterinário "${newName}" salvo!`);
                            }
                            fecharPopupEditVet();
                        });
                        formEditVet.setAttribute('data-listener-attached', 'true');
                        console.log("SCRIPT: Listener de SUBMIT para #formEditVet ADICIONADO.");
                    } else { console.log("SCRIPT: Listener de SUBMIT para #formEditVet JÁ EXISTIA."); }
                } else { console.error('SCRIPT_ERROR: Formulário #formEditVet NÃO encontrado!'); }

                const formNewService = document.getElementById('formNewService');
                if (formNewService) {
                    if (!formNewService.hasAttribute('data-listener-attached')) {
                        formNewService.addEventListener('submit', function (event) {
                            console.log("SERVICE_ADD_SUBMIT: Iniciando...");
                            event.preventDefault();
                            const submitButton = formNewService.querySelector('button[type="submit"]');
                            if (submitButton) submitButton.disabled = true;

                            const serviceNameInput = document.getElementById('newServiceNameInput');
                            let serviceName = serviceNameInput ? serviceNameInput.value.trim() : 'Serviço Padrão';
                            if (serviceNameInput && !serviceNameInput.value.trim()) {
                                alert("Por favor, insira o nome do serviço."); serviceNameInput.focus();
                                if (submitButton) submitButton.disabled = false; return;
                            }
                            const servicesContainerTarget = document.querySelector('.servicesBox .overflowBoxes');
                            if (!servicesContainerTarget) {
                                console.error('SERVICE_ADD_SUBMIT: Contêiner .overflowBoxes não encontrado.');
                                if (submitButton) submitButton.disabled = false; return;
                            }
                            const serviceDescInput = document.getElementById('newServiceDescInput');
                            const serviceDurationInput = document.getElementById('newServiceDurationInput');
                            const servicePriceInput = document.getElementById('newServicePriceInput');
                            const newServiceDesc = serviceDescInput ? serviceDescInput.value.trim() : '';
                            const newServiceDuration = serviceDurationInput ? serviceDurationInput.value.trim() : '';
                            const newServicePrice = servicePriceInput ? servicePriceInput.value.trim() : '';
                            const newServiceId = `service-${Date.now()}-${Math.random().toString(36).substring(2, 7)}`;

                            const newServiceBox = document.createElement('div');
                            newServiceBox.className = 'Box'; newServiceBox.id = newServiceId;
                            if (newServiceDesc) newServiceBox.dataset.description = newServiceDesc;
                            if (newServiceDuration) newServiceBox.dataset.duration = newServiceDuration;
                            if (newServicePrice) newServiceBox.dataset.price = newServicePrice;
                            if (servicesContainerTarget.querySelector('.Box')) { // Adiciona margin-left se já houver outros .Box
                                newServiceBox.style.marginLeft = '15px';
                            }

                            const imageElement = document.createElement('img');
                            imageElement.src = '../imgs/7f12ea1300756f144a0fb5daaf68dbfc01103a46.png'; imageElement.alt = serviceName;
                            const serviceInfoDiv = document.createElement('div'); serviceInfoDiv.className = 'alignServiceNameAndExcluirEditar';
                            const nameParagraph = document.createElement('p'); nameParagraph.textContent = serviceName;
                            const actionsDiv = document.createElement('div'); actionsDiv.className = 'excluirAndEditar';
                            const deleteLink = document.createElement('a');
                            deleteLink.href = "#"; deleteLink.className = 'excluir'; deleteLink.textContent = 'Excluir';
                            deleteLink.style.cssText = "text-decoration: none; font-size: 11px; font-family: Inter; font-weight: 500; color: #DB3938;";
                            deleteLink.addEventListener('click', function (e) { e.preventDefault(); newServiceBox.remove(); });
                            const editLink = document.createElement('a');
                            editLink.href = "#"; editLink.textContent = 'Editar';
                            editLink.style.cssText = "text-decoration: none; font-size: 11px; font-family: Inter; font-weight: 500; color: #3A8AD3; margin-left: 16px;";
                            editLink.onclick = function (e) { e.preventDefault(); abrirPopupEditService(newServiceId); return false; };

                            actionsDiv.appendChild(deleteLink); actionsDiv.appendChild(editLink);
                            serviceInfoDiv.appendChild(nameParagraph); serviceInfoDiv.appendChild(actionsDiv);
                            newServiceBox.appendChild(imageElement); newServiceBox.appendChild(serviceInfoDiv);
                            servicesContainerTarget.appendChild(newServiceBox);
                            fecharPopupCriarServico();
                            formNewService.reset();
                            console.log(`SERVICE_ADD_SUBMIT: Serviço ${newServiceId} ADICIONADO.`);
                        });
                        formNewService.setAttribute('data-listener-attached', 'true');
                        console.log("SCRIPT: Listener de SUBMIT para #formNewService ADICIONADO.");
                    }
                } else { console.error('SCRIPT_ERROR: Formulário #formNewService NÃO encontrado!'); }

                const formEditService = document.getElementById('formEditService');
                if (formEditService) {
                    if (!formEditService.hasAttribute('data-listener-attached')) {
                        formEditService.addEventListener('submit', function (event) {
                            console.log("SERVICE_EDIT_SUBMIT: Iniciando...");
                            event.preventDefault();
                            const submitButton = formEditService.querySelector('button[type="submit"]');
                            if (submitButton) submitButton.disabled = true;

                            const serviceIdToUpdate = formEditService.dataset.editingServiceId;
                            if (!serviceIdToUpdate) {
                                console.error("SERVICE_EDIT_SUBMIT: ID do serviço não encontrado.");
                                fecharPopupEditService();
                                if (submitButton) submitButton.disabled = false;
                                return;
                            }

                            const newNameInput = formEditService.querySelector('#editServiceNameInput');
                            const newServiceName = newNameInput ? newNameInput.value.trim() : '';
                            if (newNameInput && !newServiceName) {
                                alert("Nome do serviço não pode ser vazio."); newNameInput.focus();
                                if (submitButton) submitButton.disabled = false;
                                return;
                            }

                            const serviceBoxToUpdate = document.getElementById(serviceIdToUpdate);
                            if (serviceBoxToUpdate) {
                                const nameParagraph = serviceBoxToUpdate.querySelector('.alignServiceNameAndExcluirEditar p');
                                if (nameParagraph) nameParagraph.textContent = newServiceName;

                                const newDescInput = formEditService.querySelector('#editServiceDescInput');
                                const newDurationInput = formEditService.querySelector('#editServiceDurationInput');
                                const newPriceInput = formEditService.querySelector('#editServicePriceInput');
                                if (newDescInput && newDescInput.value.trim()) serviceBoxToUpdate.dataset.description = newDescInput.value.trim(); else delete serviceBoxToUpdate.dataset.description;
                                if (newDurationInput && newDurationInput.value.trim()) serviceBoxToUpdate.dataset.duration = newDurationInput.value.trim(); else delete serviceBoxToUpdate.dataset.duration;
                                if (newPriceInput && newPriceInput.value.trim()) serviceBoxToUpdate.dataset.price = newPriceInput.value.trim(); else delete serviceBoxToUpdate.dataset.price;

                                const imgElement = serviceBoxToUpdate.querySelector('img');
                                if (imgElement) imgElement.alt = newServiceName;
                                console.log(`SERVICE_EDIT_SUBMIT: Serviço ${serviceIdToUpdate} atualizado.`);
                                alert(`Serviço "${newServiceName}" salvo com sucesso!`);
                            }
                            fecharPopupEditService();
                        });
                        formEditService.setAttribute('data-listener-attached', 'true');
                        console.log("SCRIPT: Listener de SUBMIT para #formEditService ADICIONADO.");
                    }
                } else { console.error('SCRIPT_ERROR: Formulário #formEditService NÃO encontrado!'); }


                function setupStaticDeleteButton(button, closestSelector, updateStateFunction) {
                    const parentElement = button.closest(closestSelector);
                    if (parentElement && !button.hasAttribute('data-static-delete-listener')) {
                        button.addEventListener('click', function (e) {
                            e.preventDefault();
                            console.log(`STATIC_DELETE: Clicado para remover ${parentElement.id}`);
                            parentElement.remove();
                            if (updateStateFunction) updateStateFunction();
                        });
                        button.setAttribute('data-static-delete-listener', 'true');
                    }
                }
                document.querySelectorAll('.alignInsideVetList .borderNameVets a.excluir').forEach(btn => setupStaticDeleteButton(btn, '.borderNameVets', updateAddVetButtonState));
                document.querySelectorAll('.servicesBox .overflowBoxes .Box a.excluir').forEach(btn => setupStaticDeleteButton(btn, '.Box', null));
                updateAddVetButtonState();
                console.log("SCRIPT GLOBAL: Todas as configurações do DOMContentLoaded concluídas.");
            });
        </script>
    </section>
</body>

</html>